<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>concentration.py File - Cell Migration - MD (OpenMM) based simulation</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>concentration.py File | Cell Migration - MD (OpenMM) based simulation</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="concentration.py File" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/pages/user_guides/PythonScript/concentration.html" /> <meta property="og:url" content="http://localhost:4000/pages/user_guides/PythonScript/concentration.html" /> <meta property="og:site_name" content="Cell Migration - MD (OpenMM) based simulation" /> <script type="application/ld+json"> {"headline":"concentration.py File","@type":"WebPage","url":"http://localhost:4000/pages/user_guides/PythonScript/concentration.html","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Cell Migration - MD (OpenMM) based simulation </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="http://localhost:4000/pages/user_guides/installation.html" class="nav-list-link">Installation of OpenMM and FeedInForce</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/user_guides/python.html" class="nav-list-link">What's in Python Files?</a><ul class="nav-list "><li class="nav-list-item active"><a href="http://localhost:4000/pages/user_guides/PythonScript/concentration.html" class="nav-list-link active">concentration.py File</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/PythonScript/calculator.html" class="nav-list-link">calculator.py File</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/PythonScript/runner.html" class="nav-list-link">runner.py File</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/PythonScript/operator.html" class="nav-list-link">operator.py File</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/pages/user_guides/journal.html" class="nav-list-link">Work Log</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/journals/1_201212.html" class="nav-list-link">12/12/2020</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/journals/2_201215.html" class="nav-list-link">12/15/2020</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/journals/3_201216.html" class="nav-list-link">12/16/2020</a></li><li class="nav-list-item "><a href="http://localhost:4000/pages/user_guides/journals/4_201217.html" class="nav-list-link">12/17/2020</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Cell Migration - MD (OpenMM) based simulation" aria-label="Search Cell Migration - MD (OpenMM) based simulation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://colab.research.google.com/notebooks/intro.ipynb" class="site-button" > Colaboratory Link </a> </li> <li class="aux-nav-list-item"> <a href="mailto:bchun@luc.edu" class="site-button" > Contact Ben </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/pages/user_guides/python.html">What's in Python Files?</a></li> <li class="breadcrumb-nav-list-item"><span>concentration.py File</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 id="main-purpose-of-this-script"> <a href="#main-purpose-of-this-script" class="anchor-heading" aria-labelledby="main-purpose-of-this-script"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Main purpose of this scriptâ€¦ </h2> <p>A purpose of this section is mainly:</p> <ul> <li>Calculate the distance between the source of chemoattractant and the position of cell(s).</li> <li>Estimate the local concentration obtained from both the substance diffusion from the source and individual cell (auto/paracrine).</li> <li>Generate the concentration distribution in the background.</li> </ul> <h3 id="loading-the-required-python-package"> <a href="#loading-the-required-python-package" class="anchor-heading" aria-labelledby="loading-the-required-python-package"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Loading the required python package </h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#######################################################
##            Concentration Gradient Calculator      ##
##                 Written By Ben Chun               ##
#######################################################
</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span> 
</code></pre></div></div> <h3 id="error-function-based-diffusion"> <a href="#error-function-based-diffusion" class="anchor-heading" aria-labelledby="error-function-based-diffusion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Error function based diffusion </h3> <ul> <li>In this simulation there are three modes of calculation scheme for diffusion of chemoattractant substance in the background. One of three is error function based on the steady state diffusion in 1D. <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">############################
#### Diffusion function ####
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
  <span class="n">rt</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
  <span class="n">erf</span> <span class="o">=</span> <span class="n">special</span><span class="p">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">rt</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">erf</span>
<span class="c1">############################
</span></code></pre></div> </div> </li> </ul> <h3 id="calculating-distance-from-the-source-of-chemoattractant-source"> <a href="#calculating-distance-from-the-source-of-chemoattractant-source" class="anchor-heading" aria-labelledby="calculating-distance-from-the-source-of-chemoattractant-source"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Calculating distance from the source of chemoattractant source </h3> <ul> <li>There are two major types of calculations based on the location of substance sources. <ul> <li><strong>Center</strong>: the source of chemoattractant is located in the center of simulation box. Therefore, the calculation of distance between the position of cell and the location of the source is based on the radial fashion.</li> <li><strong>None</strong>: It is basically slab, the source of which is located at the end of x axis (right side).</li> </ul> </li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#############################################################################################################################
### Distance of Cell from the location of Damaged Cell
### This will be used to calculate the released substance concentration from the damaged cell at the given cell location 
</span><span class="k">def</span> <span class="nf">DistCelltoOrigin</span><span class="p">(</span><span class="n">CellCoord</span><span class="p">,</span>
                     <span class="n">Origin</span><span class="p">,</span>
                     <span class="n">SourceOfOrigin</span><span class="p">,</span>
                     <span class="n">state</span><span class="p">):</span>
    <span class="s">'''
    [Parameter descriptions]
    CellCoord:      the coordinates of particles 
    Origin:         the origin of chemoattractant source 
    SourceOfOrigin: None = One end of simulation box in x axis, Center = the center of simulation box
    state:          the characteristics of diffusion of chemoattractant: steady, error, or linear 
    '''</span>
    <span class="n">NoOfCell</span>                  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">shape</span><span class="p">(</span><span class="n">CellCoord</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">CelltoOrigin_r</span>            <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">)</span>
    <span class="n">xOrigin</span><span class="p">,</span> <span class="n">yOrigin</span><span class="p">,</span> <span class="n">zOrigin</span> <span class="o">=</span> <span class="n">Origin</span>
    <span class="n">xyOrigin</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">xOrigin</span><span class="p">,</span><span class="n">yOrigin</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">nthCell</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">):</span>
        
        <span class="c1"># Differentiate the scheme of distasnce calculation between cells and the source of external chemoattractant source
</span>        <span class="k">if</span> <span class="n">SourceOfOrigin</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">xCell</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">nthCell</span><span class="p">]</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xCell</span><span class="o">-</span><span class="n">xOrigin</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">SourceOfOrigin</span> <span class="o">==</span> <span class="s">'Center'</span><span class="p">:</span>
            <span class="n">xyCell</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">nthCell</span><span class="p">],</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">nthCell</span><span class="p">]])</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xyCell</span><span class="o">-</span><span class="n">xyOrigin</span><span class="p">)</span>
        
        <span class="n">CelltoOrigin_r</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
        
    <span class="k">return</span> <span class="n">CelltoOrigin_r</span>
</code></pre></div></div> <h3 id="calculating-distance-from-cell-to-cell"> <a href="#calculating-distance-from-cell-to-cell" class="anchor-heading" aria-labelledby="calculating-distance-from-cell-to-cell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Calculating distance from cell to cell </h3> <ul> <li>The gradient of substances in this calculation is based on <em>the error function</em>. Its source releases a certain amount, but the cells contribute the same chemical to the gradient formation (ex. ATP-mediated ATP release.)</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">####################################################################################################################
### Distance among cells 
### This will be used to calculate the released substance concentration from individual cell at the given cell location 
</span><span class="k">def</span> <span class="nf">DistCelltoCell</span><span class="p">(</span><span class="n">CellCoord</span><span class="p">):</span>
    
    <span class="n">NoOfCell</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">shape</span><span class="p">(</span><span class="n">CellCoord</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">CelltoCell_r</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">xcoord</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ycoord</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">nthCell</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">):</span>
        <span class="n">xncoord</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">nthCell</span><span class="p">]</span>
        <span class="n">yncoord</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">nthCell</span><span class="p">]</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xcoord</span><span class="o">-</span><span class="n">xncoord</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ycoord</span><span class="o">-</span><span class="n">yncoord</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">CelltoCell_r</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span> 
    
    <span class="k">return</span> <span class="n">CelltoCell_r</span> <span class="c1"># this is in dictionary form but it doesn't have to be 
</span></code></pre></div></div> <h3 id="concentration-of-substance-as-a-function-of-cell-position-with-respect-to-the-source-of-substance"> <a href="#concentration-of-substance-as-a-function-of-cell-position-with-respect-to-the-source-of-substance" class="anchor-heading" aria-labelledby="concentration-of-substance-as-a-function-of-cell-position-with-respect-to-the-source-of-substance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Concentration of substance as a function of cell position with respect to the source of substance. </h3> <ul> <li>There are three states: linear, steady, and error. <ul> <li><strong>Linear</strong>: a simple linear function (y=ax+b) governs the concentration gradientâ€™s estimation from the source of substances to the cell location.</li> <li><strong>Steady</strong>: the media is fully saturated with substances.</li> <li><strong>Error</strong>: an error function is used to estimate the concentration gradient from the source of substances to the cell location.</li> </ul> </li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#######################################################################
### Concentration of Chemoattractant released from the external source 
</span><span class="k">def</span> <span class="nf">ConcByOrigin</span><span class="p">(</span><span class="n">CelltoOrigin_r</span><span class="p">,</span>
                 <span class="n">t</span><span class="p">,</span>
                 <span class="n">D</span><span class="p">,</span>
                 <span class="n">oriConc</span><span class="p">,</span>
                 <span class="n">state</span><span class="p">,</span>
                 <span class="n">Origin</span><span class="p">):</span>
    <span class="s">'''
    [Parameter descriptions]
    CelltoOrigin_r: the distance of individual cell from the exteranl source  
    t:              time
    D:              Diffusion rate of chemoattractant 
    oriConc:        the max concentration of external chemoattractant constant 
    state:          the characteristic state of diffusion of chemoattractant 
    '''</span>
    <span class="n">xOri</span><span class="p">,</span> <span class="n">yOri</span><span class="p">,</span> <span class="n">zOri</span> <span class="o">=</span> <span class="n">Origin</span>
    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s">'linear'</span><span class="p">:</span>
        <span class="n">Conc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">CelltoOrigin_r</span><span class="o">/</span><span class="n">xOri</span><span class="p">)</span><span class="o">*</span><span class="n">oriConc</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="s">'steady'</span><span class="p">:</span>
        <span class="n">Conc</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">CelltoOrigin_r</span><span class="p">))</span><span class="o">*</span><span class="n">oriConc</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="s">'error'</span><span class="p">:</span>
        <span class="n">Conc</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">CelltoOrigin_r</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">oriConc</span>
    
    <span class="k">return</span> <span class="n">Conc</span>
</code></pre></div></div> <h3 id="concentration-of-substance-as-a-function-of-cell-position-with-respect-to-other-cells"> <a href="#concentration-of-substance-as-a-function-of-cell-position-with-respect-to-other-cells" class="anchor-heading" aria-labelledby="concentration-of-substance-as-a-function-of-cell-position-with-respect-to-other-cells"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Concentration of substance as a function of cell position with respect to other cells. </h3> <ul> <li>Their input, which is the distance of one cell from others, is a list of distance with respect to other cell positions.</li> <li>The release of a substance from each cell is a function of the concentration of substance present at the cellâ€™s position. The local concentration is applied to the Hillâ€™s equation that generates the coefficient and controls the degree of release.</li> <li><strong><em>[Things to remember]</em></strong> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CelltoCell_r</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="p">...</span> <span class="n">nth_distance</span> <span class="p">]</span>
</code></pre></div> </div> </li> <li>This being said, the data generated by usind this distance will contain the series of substance concentration at each individual location by the selected cell.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##########################################################################################
### Concentration of Chemoattractant reased from the indivudal cells
</span><span class="k">def</span> <span class="nf">ConcByCell</span><span class="p">(</span><span class="n">ConcByOrigin</span><span class="p">,</span>
               <span class="n">ConcByCell</span><span class="p">,</span>
               <span class="n">CelltoCell_r</span><span class="p">,</span>
               <span class="n">t</span><span class="p">,</span>
               <span class="n">D</span><span class="p">,</span>
               <span class="n">kd</span><span class="p">,</span>
               <span class="n">auto_factor</span><span class="p">,</span>
               <span class="n">cellConc</span><span class="p">):</span>
    <span class="s">'''
    [Parameter description]
    ConcByOrigin: the concentration released by the external source 
    ConcByCell:   the concentration released by the cell
    CelltoCell_r: the distance among cells dictionary form 
    t:            time
    D:            diffusion rate 
    kd:           constant associated with Hills coefficient for autocrinic release
    auto_factor:  a list of autocrinic factors based on the state of cells
    cellConc:     the max concentration released by cells (determining the degree of intercellular communication)
    '''</span>

    <span class="n">NoOfCell</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ConcByOrigin</span><span class="p">)</span>
    <span class="n">ConcByCell</span> <span class="o">=</span> <span class="n">ConcByOrigin</span> <span class="o">+</span> <span class="n">ConcByCell</span>        
    <span class="n">HillsCoefficient</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">((</span><span class="n">kd</span><span class="o">*</span><span class="n">auto_factor</span><span class="p">)</span><span class="o">/</span><span class="n">ConcByCell</span><span class="p">))</span> <span class="c1">## So far, there is no degree of coopertivity &lt;---- this is where I can make adjustment for resting and activated cells 
</span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">nthCell</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">CelltoCell_r</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="c1">## array with length of NoOfCell 
</span>        <span class="n">dummydata</span> <span class="o">=</span> <span class="n">HillsCoefficient</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">cellConc</span> <span class="c1">## array (from specific cell to all cells)
</span>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="n">dummydata</span> 
        
    <span class="n">ConcByCell</span> <span class="o">=</span> <span class="n">ConcByCell</span> <span class="o">+</span> <span class="n">data</span>
    <span class="n">HillsCoefficient</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">((</span><span class="n">kd</span><span class="o">*</span><span class="n">auto_factor</span><span class="p">)</span><span class="o">/</span><span class="n">ConcByCell</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">ConcByCell</span><span class="p">,</span> <span class="n">HillsCoefficient</span>
</code></pre></div></div> <h3 id="force-generator-based-on-the-concentration-gradient"> <a href="#force-generator-based-on-the-concentration-gradient" class="anchor-heading" aria-labelledby="force-generator-based-on-the-concentration-gradient"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Force Generator based on the concentration gradient </h3> <ul> <li>This specific code will generate vector indicating the degree of force generated by the concentration gradient. <ul> <li>Direction of vector will be against graident, meaning that from low to high concentration.</li> <li><strong><em>Warning</em></strong>: we have not determined the degree of migration based on the concentration gradient. Therefore, the unit is arbitrary.</li> </ul> </li> <li>Searching/estimating the concentration gradient <ol> <li>Select a cell</li> <li>Generate coordinates for cellâ€™s surroundings <ul> <li>x11: x coordinate for the selected cell</li> <li>x01: x11 - searching range</li> <li>x21: x11 + searching range</li> <li>vice versa for y coordinate.</li> <li>A total of 5 sets of (x,y) are generated from this process</li> </ul> </li> <li>Calculate the distance of each coordinate from the preceeding process to the location of the chemoattractantâ€™s source.</li> <li>Calculate the distance of each coordinate from the surroundings to other cells</li> <li>Combine the concentration of substance released by other cells and the concentration of substance released from the source.</li> <li>Calculate the vector in x and y direction based on the concentration differences.</li> <li>Multiply each element of force by random probability with slighly bias medium <ul> <li>The center of normal distribution is 0.25</li> <li>If there is no gradient then there will be no force (duhâ€¦ obviously)</li> </ul> </li> <li>To exaggerate the motion of cell with respect to the local concentration, we introduce another random factor obtained another normal distribution whose center is 0.0. <ul> <li>In <em>Brownian</em> motion, the temperature should be adjust to control the motion of particle. In this case, due to the technical difficulty, it is not possible to locally reassign the temperature of each individual particle or cell.</li> <li>Therefore, we are simply applying a new set of force.</li> <li>The motion is a bit sensitive to the constant multiplied to the random probability.</li> <li><strong><em>Warning</em></strong>: something needs to be done with the case of evenly distributed chemoattractant media.</li> </ul> </li> </ol> </li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#######################################################################################################
### Generate the force of migration based on the gradient of chemoattractant along wiht Brownian Motion
</span><span class="k">def</span> <span class="nf">forceGen</span><span class="p">(</span><span class="n">ConcByCell</span><span class="p">,</span>
             <span class="n">Origin</span><span class="p">,</span>
             <span class="n">SourceOfOrigin</span><span class="p">,</span>
             <span class="n">CellCoord</span><span class="p">,</span>
             <span class="n">t</span><span class="p">,</span>
             <span class="n">D</span><span class="p">,</span>
             <span class="n">HillsCoefficient</span><span class="p">,</span>
             <span class="n">searchingRange</span><span class="p">,</span>
             <span class="n">highBC</span><span class="p">,</span>
             <span class="n">DisplacementScaleByConc</span><span class="p">,</span>
             <span class="n">cellConc</span><span class="p">,</span>
             <span class="n">oriConc</span><span class="p">,</span>
             <span class="n">state</span><span class="p">):</span>
    <span class="s">'''
    [Parameter description]
    ConcByCell:                 the concentration released by the cell
    Origin:                     the origin of chemoattractant source
    SourceOfOrigin:             None = One end of simulation box in x axis, Center = the center of simulation box 
    CellCoord:                  position of cells from pdb file 
    t:                          time
    D:                          diffusion rate 
    HillsCoefficient:           Hills coefficient for autocrinic release 
    searchingRange:             searching range around the cell
    highBC:                     [max X, max Y, max Z]
    DisplacementScaleByConc:    the degree of displacement 
    cellConc:                   the max concentration of chemoattractant released from the cell via autocrine 
    oriConc:                    the max concentration of chemoattractant released from the external source 
    state:                      the characteristics of diffusion of chemoattractant: steady, error, or linear 
    '''</span>       

    <span class="n">NoOfCell</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">shape</span><span class="p">(</span><span class="n">CellCoord</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">highBCx</span><span class="p">,</span> <span class="n">highBCy</span><span class="p">,</span> <span class="n">highBCz</span> <span class="o">=</span> <span class="n">highBC</span>
    <span class="c1">## x1,y1,z1 denotes the x,y,z coordinate of cell location
</span>    <span class="n">FVectorX</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">)</span>
    <span class="n">FVectorY</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">)</span>
    <span class="n">FVectorZ</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">)</span>
    
    <span class="c1"># x
</span>    <span class="n">xtest</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">searchingRange</span><span class="p">,</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">searchingRange</span><span class="p">])</span>

    <span class="c1"># y
</span>    <span class="n">ytest</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">searchingRange</span><span class="p">,</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">searchingRange</span><span class="p">])</span>

    <span class="c1"># the distance from the one end where ATP is being released
</span>    <span class="k">if</span> <span class="n">SourceOfOrigin</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1">#rSource = np.array([abs(Origin[0]-xtest[0]),abs(Origin[0]-xtest[1]),abs(Origin[0]-xtest[2])])
</span>        <span class="n">r0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">xtest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">xtest</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">xtest</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        
        <span class="n">Conc_Origin0</span> <span class="o">=</span> <span class="n">ConcByOrigin</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">oriConc</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">Origin</span><span class="p">)</span>
        <span class="n">Conc_Origin1</span> <span class="o">=</span> <span class="n">ConcByOrigin</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">oriConc</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">Origin</span><span class="p">)</span>
        <span class="n">Conc_Origin2</span> <span class="o">=</span> <span class="n">ConcByOrigin</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">oriConc</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">Origin</span><span class="p">)</span>
        
        <span class="n">COarray</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">Conc_Origin0</span><span class="p">,</span><span class="n">Conc_Origin2</span><span class="p">,</span><span class="n">Conc_Origin1</span><span class="p">,</span><span class="n">Conc_Origin1</span><span class="p">,</span><span class="n">Conc_Origin1</span><span class="p">])</span>
        <span class="c1">#print(len(COarray))
</span>
    <span class="k">elif</span> <span class="n">SourceOfOrigin</span> <span class="o">==</span> <span class="s">'Center'</span><span class="p">:</span>
        <span class="n">xSource</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x0</span><span class="p">),(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x1</span><span class="p">),(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x2</span><span class="p">)])</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">ySource</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y0</span><span class="p">),(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y1</span><span class="p">),(</span><span class="n">Origin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y2</span><span class="p">)])</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">rSource</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">xSource</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ySource</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xSource</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">ySource</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xSource</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ySource</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xSource</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ySource</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">xSource</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">ySource</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
        <span class="n">COarray</span> <span class="o">=</span> <span class="n">ConcByOrigin</span><span class="p">(</span><span class="n">rSource</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">oriConc</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">Origin</span><span class="p">)</span>


    <span class="n">xcell</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ycell</span> <span class="o">=</span> <span class="n">CellCoord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">xprob</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">NoOfCell</span><span class="p">)</span>
    <span class="n">yprob</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">NoOfCell</span><span class="p">)</span>
    
    <span class="n">xrand</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">NoOfCell</span><span class="p">)</span>
    <span class="n">yrand</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">NoOfCell</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">nthCell</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NoOfCell</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cellConc</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">CCarray</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>    
            <span class="n">rfromCells01</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xcell</span><span class="o">-</span><span class="p">(</span><span class="n">xcell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">-</span><span class="n">searchingRange</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ycell</span><span class="o">-</span><span class="n">ycell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">rfromCells21</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xcell</span><span class="o">-</span><span class="p">(</span><span class="n">xcell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">+</span><span class="n">searchingRange</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ycell</span><span class="o">-</span><span class="n">ycell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
            <span class="n">rfromCells10</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xcell</span><span class="o">-</span><span class="n">xcell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ycell</span><span class="o">-</span><span class="p">(</span><span class="n">ycell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">-</span><span class="n">searchingRange</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">rfromCells12</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xcell</span><span class="o">-</span><span class="n">xcell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ycell</span><span class="o">-</span><span class="p">(</span><span class="n">ycell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">+</span><span class="n">searchingRange</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">rfromCells11</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xcell</span><span class="o">-</span><span class="n">xcell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ycell</span><span class="o">-</span><span class="n">ycell</span><span class="p">[</span><span class="n">nthCell</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            
            <span class="n">CCarray</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="nb">sum</span><span class="p">(</span><span class="n">HillsCoefficient</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">rfromCells01</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">cellConc</span><span class="p">),</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">HillsCoefficient</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">rfromCells21</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">cellConc</span><span class="p">),</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">HillsCoefficient</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">rfromCells10</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">cellConc</span><span class="p">),</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">HillsCoefficient</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">rfromCells12</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">cellConc</span><span class="p">),</span>
                                <span class="nb">sum</span><span class="p">(</span><span class="n">HillsCoefficient</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">rfromCells11</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">cellConc</span><span class="p">)])</span>
        
        <span class="n">ConcTotal</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">COarray</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">nthCell</span><span class="p">],</span><span class="n">COarray</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">nthCell</span><span class="p">],</span><span class="n">COarray</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">nthCell</span><span class="p">],</span><span class="n">COarray</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">nthCell</span><span class="p">],</span><span class="n">COarray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">nthCell</span><span class="p">]])</span> <span class="o">+</span> <span class="n">CCarray</span>

        <span class="c1">## Calculating the concentration gradient         
</span>        <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">ConcTotal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ConcTotal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ConcTotal</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">ConcTotal</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">dz</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Determining in X direction force
</span>        <span class="n">xp</span> <span class="o">=</span> <span class="n">xprob</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span>
        <span class="n">DispX</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">xp</span>
        
        <span class="c1"># Determining in Y direction force
</span>        <span class="n">yp</span> <span class="o">=</span> <span class="n">yprob</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span>    
        <span class="n">DispY</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="n">yp</span>
                
        <span class="n">FVectorX</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisplacementScaleByConc</span><span class="o">*</span><span class="p">(</span><span class="n">DispX</span> <span class="o">+</span> <span class="n">xrand</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">*</span><span class="mf">0.015</span><span class="p">)</span><span class="o">*</span><span class="n">ConcTotal</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">FVectorY</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisplacementScaleByConc</span><span class="o">*</span><span class="p">(</span><span class="n">DispY</span> <span class="o">+</span> <span class="n">yrand</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span><span class="o">*</span><span class="mf">0.015</span><span class="p">)</span><span class="o">*</span><span class="n">ConcTotal</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">FVectorZ</span><span class="p">[</span><span class="n">nthCell</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">return</span> <span class="n">FVectorX</span><span class="p">,</span> <span class="n">FVectorY</span><span class="p">,</span> <span class="n">FVectorZ</span>
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
